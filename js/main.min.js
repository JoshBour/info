$(function(){function o(e){if(e)s=setInterval(function(){$("#slideShowPics").find(".slide:first").fadeOut("slow",function(){$(this).next(".slide").fadeIn("slow").end().appendTo("#slideShowPics")})},7e3);else clearInterval(s)}var e=$("body");var t=$("#flash");var n;if(t.is(":visible")){t.setRemoveTimeout(3e3)}var r=new Gettext({domain:"messages"});$(".printTrigger").on("click",function(e){e.preventDefault();window.print()});$(document).on("click",function(e){if(e.target.id=="shadow"){n.unfocusLight();$("body").removeClass("unscrollable");n.detach()}});var i=$(".tabs span");i.each(function(){var e=$(this);var t=e.attr("class").split(" ")[0].substr(4);if(e.hasClass("activeTab")){$("#"+t).show()}else{$("#"+t).hide()}});i.on("click",function(){var e=$(this);if(!e.hasClass("activeTab")){var t=e.siblings(".activeTab").removeClass("activeTab");$("#"+t.attr("class").split(" ")[0].substr(4)).fadeOut("normal",function(){$("#"+e.attr("class").split(" ")[0].substr(4)).fadeIn()});e.addClass("activeTab")}});var s=null;o(true);$("#slideShowPics").find(".slide:gt(0)").hide();$('span[class$="Toggle"]').on("click",function(){resetActiveField();var t=$(this).attr("class");var n=$("#"+t.substr(0,t.length-6));if(n.is(":visible")){resetActiveField();n.slideToggle("normal",function(){ofh=new $.fn.dataTable.FixedHeader(table)})}else{n.slideToggle();e.children(".fixedHeader").each(function(){$(this).remove()})}});$("#slideLeft").on("click",function(){o(false);$("#slideShowPics").find(".slide:first").fadeOut("slow",function(){$(this).siblings(".slide:last-of-type").fadeIn("slow").prependTo("#slideShowPics")});o(true)});$("#slideRight").on("click",function(){o(false);$("#slideShowPics").find(".slide:first").fadeOut("slow",function(){$(this).next(".slide").fadeIn("slow").end().appendTo("#slideShowPics")});o(true)});var u=false;var a=$("#categories").html();$(".search input").on("keyup",function(e){var t=$(this).val().trim().toLowerCase();delay(function(){e.preventDefault();if(!u){u=true;var n=$("#categories");if(t.length==0){n.html(a)}else if(t.length>1){$.ajax({url:baseUrl+"/products/search/"+t,type:"GET"}).success(function(e){if($.trim(e)!=""){n.html(e)}}).error(function(){addMessage(r.gettext("Something with wrong, please try again."))})}u=false}},150)});if(e.hasClass("productPage")){$(".productAttributes tbody tr").on("click",function(){window.location=$(this).next("tr.productMeta").find("a").attr("href")})}$(".magnifiable").on("click",function(){var t=$(this);var r=t.attr("src");var i=$("<div/>",{id:"stageWrapper"}).prependTo($("body"));var s=$("<div/>",{id:"stage"}).appendTo(i);var o=$("<div/>",{id:"imageWrapper"}).appendTo(s);var u=$("<img/>",{src:r}).appendTo(o);n=i;i.focusLight();i.css({width:u.width(),"margin-left":-(u.width()/2)});e.addClass("unscrollable")})})